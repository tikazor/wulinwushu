{% extends "base.html" %}
{% block content %}
<div class="max-w-7xl mx-auto py-8">
  <h1 class="text-3xl font-bold mb-6 text-center">Ateliers</h1>
  <form method="get" class="mb-6 flex gap-2 justify-center">
    <input type="text" name="q" placeholder="Recherche (nom, consigne, technique...)" value="{{ q }}" class="input input-bordered w-full max-w-xs rounded-lg px-4 py-2 border border-gray-300">
    <button type="submit" class="inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2">
      üîç
    </button>
    {% if q %}
      <a href="{% url 'liste_ateliers' %}" class="text-red-500 ml-2">‚úñ Effacer</a>
    {% endif %}
  </form>
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {% for at in ateliers %}
      <a href="{% url 'detail_atelier' at.pk %}" class="block group h-full">
        <div class="bg-white rounded-2xl shadow-lg flex flex-col h-full hover:scale-105 transition overflow-hidden">
          {% if at.image %}
            <img src="{{ at.image.file.url }}" alt="{{ at.nom }}" class="w-full h-32 object-cover rounded-t-2xl" />
          {% endif %}
          <div class="flex-1 p-6 flex flex-col">
            <h2 class="font-semibold text-lg mb-2 group-hover:text-blue-600">{{ at }}</h2>
            <div class="text-xs text-green-800 bg-green-100 rounded px-2 py-1 inline-block mb-2">{{ at.duree }} min</div>
            {% if at.consigne %}
              <p class="text-sm text-gray-600 italic mb-2">{{ at.consigne|truncatewords:15 }}</p>
            {% endif %}
            {% if at.techniques.all %}
              <div class="mt-2 text-xs text-gray-500">
                <span class="font-semibold">Techniques :</span>
                {% for tech in at.techniques.all|slice:":3" %}
                  {{ tech.nom }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
                {% if at.techniques.count > 3 %}...{% endif %}
              </div>
            {% endif %}
          </div>
        </div>
      </a>
    {% empty %}
      <div class="col-span-full text-center text-gray-500">Aucun atelier trouv√©.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
