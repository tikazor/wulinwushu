{% extends "base.html" %}
{% block content %}
<div class="max-w-7xl mx-auto py-8">
  <h1 class="text-3xl font-bold mb-6 text-center">Techniques</h1>

      <form method="get" class="flex flex-wrap gap-4 mb-6">
    <input
      type="text"
      name="q"
      value="{{ q }}"
      placeholder="Rechercher une technique..."
      class="rounded-lg border-gray-300 focus:border-rouge-charte focus:ring focus:ring-rouge-charte px-3 py-2 bg-gray-50"
    />

    <select name="style" class="rounded-lg border-gray-300 px-3 py-2 bg-gray-50">
      <option value="">Style (tous)</option>
      {% for s in styles %}
        <option value="{{ s }}" {% if selected_style == s %}selected{% endif %}>{{ s|capfirst }}</option>
      {% endfor %}
    </select>

    <select name="zone" class="rounded-lg border-gray-300 px-3 py-2 bg-gray-50">
      <option value="">Zone (toutes)</option>
      {% for z in zones %}
        <option value="{{ z }}" {% if selected_zone == z %}selected{% endif %}>{{ z|capfirst }}</option>
      {% endfor %}
    </select>

    <select name="categorie" class="rounded-lg border-gray-300 px-3 py-2 bg-gray-50">
      <option value="">Catégorie (toutes)</option>
      {% for c in categories %}
        <option value="{{ c }}" {% if selected_categorie == c %}selected{% endif %}>{{ c|capfirst }}</option>
      {% endfor %}
    </select>

    <button
      type="submit"
      class="bg-rouge-charte hover:bg-red-700 text-white font-semibold rounded-lg px-4 py-2 transition"
    >Filtrer</button>
  </form>


    {% if q %}<a href="{% url 'liste_techniques' %}" class="text-red-500 ml-2">✖ Effacer</a>{% endif %}
  </form>
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {% for tech in techniques %}
      <a href="{% url 'detail_technique' tech.pk %}" class="block group">
        <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col hover:scale-105 transition-all duration-300 h-full group-hover:border-blue-500 border border-transparent">
          {% if tech.image %}
            <img src="{{ tech.image.file.url }}" alt="{{ tech.nom }}" class="w-full h-32 object-cover rounded-xl mb-3">
            

          {% endif %}
          <h2 class="text-lg font-semibold mb-1 group-hover:text-blue-600">{{ tech.nom|default:tech.nom_pinyin }}</h2>
          <div class="text-xs text-gray-500 mb-2">
            {{ tech.traduction }}{% if tech.nom_chinois %} — {{ tech.nom_chinois }}{% endif %}
          </div>
          <div class="text-xs text-indigo-800 bg-indigo-100 rounded px-2 py-1 mb-1 w-max">
            {{ tech.get_categorie_display }}
          </div>
          <div class="text-xs text-green-700 bg-green-50 rounded px-2 py-1 mb-1 w-max">
            {{ tech.get_style_display }}
          </div>
          <p class="text-sm text-gray-600 mt-1 mb-2">{{ tech.description|truncatewords:16 }}</p>
        </div>
      </a>
    {% empty %}
      <div class="col-span-full text-center text-gray-500">Aucune technique trouvée.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
